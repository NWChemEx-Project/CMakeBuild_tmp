if(BLAS_INT4)
    set(LINALG_REQUIRED_COMPONENTS "lp64")
else()
    set(LINALG_REQUIRED_COMPONENTS "ilp64")
endif()

if("${LINALG_VENDOR}" STREQUAL "IntelMKL")
    set(LINALG_THREAD_LAYER "sequential")
    if(USE_OPENMP)
        set(LINALG_THREAD_LAYER "openmp")
    endif()
elseif("${LINALG_VENDOR}" STREQUAL "IBMESSL")
    set(LINALG_THREAD_LAYER "serial")
    if(USE_OPENMP)
        set(LINALG_THREAD_LAYER "smp")
    endif()
endif()

set(BLAS_PREFERENCE_LIST      ${LINALG_VENDOR})
set(LAPACK_PREFERENCE_LIST    ${LINALG_VENDOR})
set(ScaLAPACK_PREFERENCE_LIST ${LINALG_VENDOR})

set(LINALG_PREFER_STATIC ON)
if(BUILD_SHARED_LIBS)
    set(LINALG_PREFER_STATIC OFF)
endif()

if(ENABLE_DPCPP)
    set(LINALG_THREAD_LAYER "sequential")
endif()

set(${LINALG_VENDOR}_PREFERS_STATIC    ${LINALG_PREFER_STATIC})
set(BLAS_PREFERS_STATIC                ${LINALG_PREFER_STATIC})
set(ReferenceLAPACK_PREFERS_STATIC     ${LINALG_PREFER_STATIC})
set(ReferenceScaLAPACK_PREFERS_STATIC  ${LINALG_PREFER_STATIC})

set(${LINALG_VENDOR}_THREAD_LAYER  ${LINALG_THREAD_LAYER})
set(BLAS_REQUIRED_COMPONENTS       ${LINALG_REQUIRED_COMPONENTS})
set(LAPACK_REQUIRED_COMPONENTS     ${LINALG_REQUIRED_COMPONENTS})
set(ScaLAPACK_REQUIRED_COMPONENTS  ${LINALG_REQUIRED_COMPONENTS})
set(BLAS_OPTIONAL_COMPONENTS       ${LINALG_OPTIONAL_COMPONENTS})
set(LAPACK_OPTIONAL_COMPONENTS     ${LINALG_OPTIONAL_COMPONENTS})
set(ScaLAPACK_OPTIONAL_COMPONENTS  ${LINALG_OPTIONAL_COMPONENTS})    

set(BLAS_THREAD_LAYER              ${LINALG_THREAD_LAYER})
set(LAPACK_THREAD_LAYER            ${LINALG_THREAD_LAYER})
set(ScaLAPACK_THREAD_LAYER         ${LINALG_THREAD_LAYER})

set(BLAS_PREFIX   "${LINALG_PREFIX}")
if(${LINALG_VENDOR} STREQUAL "BLIS" OR ${LINALG_VENDOR} STREQUAL "OpenBLAS" OR ${LINALG_VENDOR} STREQUAL "IBMESSL")
    set(LAPACK_PREFERENCE_LIST ReferenceLAPACK)
    if(USE_SCALAPACK)
        set(ScaLAPACK_PREFERENCE_LIST ReferenceScaLAPACK)
        # find_or_build_dependency(ScaLAPACK)
        set(ScaLAPACK_PREFIX "${CMAKE_INSTALL_PREFIX}")
    # else()
        # find_or_build_dependency(LAPACK)
    endif()

    set(LAPACK_PREFIX   "${CMAKE_INSTALL_PREFIX}")
    if(${LINALG_VENDOR} STREQUAL "BLIS" OR ${LINALG_VENDOR} STREQUAL "OpenBLAS")
        set(BLAS_PREFIX   "${CMAKE_INSTALL_PREFIX}")
    endif()
endif()

if(NOT LAPACK_PREFIX)
  set(LAPACK_PREFIX ${LINALG_PREFIX})
endif()
if(NOT ScaLAPACK_PREFIX)
  set(ScaLAPACK_PREFIX ${LINALG_PREFIX})
endif()
